#!/bin/bash

##
## ncsv2ip
## -------
## Converts a Nessus exported CSV file to a colon-separated list of IPs and ports
##
## Usage: ncsv2ip [CSV FILE]
##
## Requires: grep, awk, sort
## Limitations: Only outputs TCP ports. UDP ports are ignored.
##

if [ "$1" == "" ] || [ "$1" == "--help" ] || [ "$1" == "-h" ] ; then
    grep -E '^## ?' "$0" | sed -E 's/^## ?//g'
    exit
fi

CSV_FILE=$1

grep -iE '^"[0-9].+,"tcp","[1-9][0-9]*",' "$CSV_FILE" | awk -F '"' '{print $10 ":" $14}' | sort -u
