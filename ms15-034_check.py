#!/usr/bin/env python

import sys
import requests

# Disable warnings about invalid SSL certificates
import warnings
warnings.filterwarnings("ignore")

if len(sys.argv) <= 1 or '-h' in sys.argv or '--help' in sys.argv:
    print "Usage: %s <URL>"
    print 
    print "Example: %s 'https://example.com:8443/'"
    exit()

url = sys.argv[1]
headers = {'Range': 'bytes=0-18446744073709551615'}

r = requests.get(url, stream=True, verify=False, headers=headers)

if "Requested Range Not Satisfiable" in r.text:
    print "[+] %s  - Looks VULNERABLE!" % url
elif "The request has an invalid header name" in r.text:
    print "[-] %s - Looks patched" % url
else:
    print "[!] %s - Unexpected response. Cannot discern patch status" % url


