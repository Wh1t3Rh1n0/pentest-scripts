#!/bin/bash

##
## grip
## ----
## greps a file for common patterns.
##
## Should accept most standard grep flags.
##
## Example usage:
##    grep for IPs only:      grip <filename>
##    include CIDR notation:  grip --cidr <filename>
##    grep for IP:Port:       grip --port <filename>
##    grep for emails:        grip --email <filename>
##    grep for MAC addresses: grip --mac <filename>
##

if [ "$1" == "-h" ] || [ "$1" == "--help" ] ; then
    grep "^##" "$0"
    exit
fi

if [ "$1" == "--port" ] ; then
    grep -iEo "(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(:[0-9]+)?" $(echo $* | sed 's/--port//g')
    exit
fi

if [ "$1" == "--email" ] ; then
    grep -Eoa '[A-Za-z0-9\._-]+@[A-Za-z0-9\._-]+' $(echo $* | sed 's/--email//g')
    exit
fi

if [ "$1" == "--cidr" ] ; then
    grep -iEoa "(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(/[0-9]+)?" $(echo $* | sed 's/--cidr//g')
    exit
fi

if [ "$1" == "--mac" ] ; then
    grep -iEao '([abcdef0-9]{2}[:-]){5}[abcdef0-9]{2}' $(echo $* | sed 's/--mac//g')
    exit
fi


grep -iEao "(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])" $*
