#!/bin/bash

##
## greps a file for valid IPv4 addresses.
##
## Usage:
##    grep for IPs only:  grip <filename>
##    grep for IP:Port:   grip --port <filename>
##    grep for emails:    grip --email <filename>
##

if [ "$1" == "-h" ] || [ "$1" == "--help" ] ; then
    grep "^##" "$0"
    exit
fi

if [ "$1" == "--port" ] ; then
    grep -iEo "(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9]):[0-9]+" $(echo $* | sed 's/--port//g')
    exit
fi

if [ "$1" == "--email" ] ; then
    grep -Eo '[A-Za-z0-9\._-]+@[A-Za-z0-9\._-]+' $(echo $* | sed 's/--email//g')
    exit
fi

grep -iEo "(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])" $*
